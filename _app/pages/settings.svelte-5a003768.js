var se=Object.defineProperty;var Y=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var ie=(s,e,t)=>e in s?se(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var $=(s,e)=>{var t={};for(var n in s)ae.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&Y)for(var n of Y(s))e.indexOf(n)<0&&oe.call(s,n)&&(t[n]=s[n]);return t};var P=(s,e,t)=>(ie(s,typeof e!="symbol"?e+"":e,t),t);import{ae as Z,S as re,i as le,s as ue,j as S,e as m,t as g,K as pe,d as b,l as T,c as d,a as U,g as k,b as M,f as ee,F as a,Q as E,R,U as te,G as ne,V as ce,I as he}from"../chunks/vendor-61e2293a.js";import{d as D}from"../chunks/index-dbb8b31c.js";import{M as me}from"../chunks/Momento-2e6f8e28.js";class F{constructor(e){P(this,"rows",[]);P(this,"wchs",[]);this.name=e}build(e){}count(e,t){const n=`${e}`.length*1.5;return this.wchs[t]=(this.wchs[t]||0)<n?n:this.wchs[t],e}format(e){return e["!cols"]=this.wchs.map(t=>({wch:t})),e}}class de extends F{constructor(){super("LED");P(this,"blockWidth",3);P(this,"margin",1)}build(e){e.leds.forEach(t=>{this.rows.push([t.title,"nombre dans le hall",t.hall||"-"],[,"nombre dans les couloirs",t.hallways||"-"],[t.subTitle,"nombre en exterieur",t.outdoors||"-"],...t.films.map(n=>[e.titles.find(i=>i._id===n).name]))})}format(e){return e["!cols"]=[{width:50},{width:25}],e}}class fe extends F{constructor(){super("FA");this.rows.push(["N\xB0SEMAINE","CODE ENQ.","VILLE","CIRCUIT","COMPLEXE","N\xB0 DE SALLE","SEANCE/FILM","2D/3D","AVANT SEANCE","CONTENU","ORDRE","DUREE AVANT SEANCE","DATE","HORAIRE"])}build(e){const t=e.movieAds.flatMap(n=>{const i=n.ads.reduce((l,u)=>{const p=e.titles.find(_=>_._id===u.titleId);return u.group?l.push({name:p.group.start,type:p.type},...u.group.ads.map(_=>{const c=$(e.titles.find(O=>O._id===_),[]);return c.type!==p.group.suffix&&(c.type+=` ${p.group.suffix}`),c.type=c.type,c}),{name:p.group.end,type:p.type}):l.push(p),l},[]),o=me.diffMinutes(n.start,n.end),w=new Intl.DateTimeFormat("fr-FR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),[f,v]=w.format(new Date(n.start)).split(", ");return i.map((l,u)=>[e.week,e.code,e.city.toUpperCase(),e.circuit.toUpperCase(),e.name.toUpperCase(),n.room,n.film.toUpperCase(),n.dimension.toUpperCase(),l.name.toUpperCase(),l.type.toUpperCase(),u+1,o,f.toUpperCase(),v.toUpperCase()].map((p,_)=>this.count(p,_)))});this.rows.push(...t)}}class be extends F{constructor(){super("AFFICHES");this.rows.push(["SEMAINE","CODE ENQ.","VILLE","CIRCUIT","COMPLEXE","AFFICHE FILM","POSITIONNEMENT","FORMAT"])}build(e){const t=e.posters.map(n=>{const i=e.titles.find(o=>o._id===n.titleId);return[e.week,e.code,e.city.toUpperCase(),e.circuit.toUpperCase(),e.name.toUpperCase(),i.name.toUpperCase(),n.location.toUpperCase(),n.type.toUpperCase()].map((o,w)=>this.count(o,w))});this.rows.push(...t)}}class Ee extends F{constructor(){super("REMARQUES")}}const we=(s,e)=>{const t=URL.createObjectURL(s),n=document.createElement("a");n.style.display="none",n.href=t,n.download=e,document.body.appendChild(n),n.click(),URL.revokeObjectURL(t),document.body.removeChild(n)};class _e{constructor(e,t){this.filename=e,this.$datas=t,this.wb=Z.utils.book_new(),this.wb.Props={CreatedDate:new Date}}setSheet(e){e.build(this.$datas),this.wb.SheetNames.push(e.name),this.wb.Sheets[e.name]=e.format(Z.utils.aoa_to_sheet(e.rows));const t={style:"thin",color:{auto:1}},n=/^[A-Z]+\d+$/;Object.keys(this.wb.Sheets[e.name]).forEach(i=>{if(!n.test(i))return;const o=this.wb.Sheets[e.name][i];o.t=`<t>${o.v}</t>`,o.s={font:{name:"Arial"},alignment:{vertical:"center"},border:{top:t,bottom:t,left:t,right:t}}})}s2ab(e){let t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let i=0;i<e.length;i++)n[i]=e.charCodeAt(i)&255;return t}download(){const e=Z.write(this.wb,{bookType:"xlsx",type:"binary"}),t=new Blob([this.s2ab(e)],{type:"application/octet-stream"});we(t,this.filename+".xlsx")}}function ye(s){let e,t,n,i,o,w,f,v,l,u,p,_,c,O,N,j,C,B,L,V,A,q,I,Q,X,z;return document.title=""+({}.APP_NAME+" - Param\xE8tres"),{c(){e=S(),t=m("main"),n=m("label"),i=g(`Code enqu\xEAteur
		`),o=m("input"),w=S(),f=m("label"),v=g(`Semaine n\xB0
		`),l=m("input"),u=S(),p=m("label"),_=g(`Nom du cin\xE9ma
		`),c=m("input"),O=S(),N=m("label"),j=g(`Ville
		`),C=m("input"),B=S(),L=m("label"),V=g(`Circuit
		`),A=m("input"),q=S(),I=m("button"),Q=g("T\xE9l\xE9charger le tableau"),this.h()},l(r){pe('[data-svelte="svelte-1g4h5xy"]',document.head).forEach(b),e=T(r),t=d(r,"MAIN",{class:!0});var h=U(t);n=d(h,"LABEL",{});var H=U(n);i=k(H,`Code enqu\xEAteur
		`),o=d(H,"INPUT",{type:!0}),H.forEach(b),w=T(h),f=d(h,"LABEL",{});var x=U(f);v=k(x,`Semaine n\xB0
		`),l=d(x,"INPUT",{type:!0}),x.forEach(b),u=T(h),p=d(h,"LABEL",{});var G=U(p);_=k(G,`Nom du cin\xE9ma
		`),c=d(G,"INPUT",{type:!0}),G.forEach(b),O=T(h),N=d(h,"LABEL",{});var K=U(N);j=k(K,`Ville
		`),C=d(K,"INPUT",{type:!0}),K.forEach(b),B=T(h),L=d(h,"LABEL",{});var W=U(L);V=k(W,`Circuit
		`),A=d(W,"INPUT",{type:!0}),W.forEach(b),q=T(h),I=d(h,"BUTTON",{});var J=U(I);Q=k(J,"T\xE9l\xE9charger le tableau"),J.forEach(b),h.forEach(b),this.h()},h(){M(o,"type","text"),M(l,"type","number"),M(c,"type","text"),M(C,"type","text"),M(A,"type","text"),M(t,"class","svelte-gedgj2")},m(r,y){ee(r,e,y),ee(r,t,y),a(t,n),a(n,i),a(n,o),E(o,s[0].code),a(t,w),a(t,f),a(f,v),a(f,l),E(l,s[0].week),a(t,u),a(t,p),a(p,_),a(p,c),E(c,s[0].name),a(t,O),a(t,N),a(N,j),a(N,C),E(C,s[0].city),a(t,B),a(t,L),a(L,V),a(L,A),E(A,s[0].circuit),a(t,q),a(t,I),a(I,Q),X||(z=[R(o,"input",s[2]),R(l,"input",s[3]),R(c,"input",s[4]),R(C,"input",s[5]),R(A,"input",s[6]),R(I,"click",s[1])],X=!0)},p(r,[y]){y&1&&o.value!==r[0].code&&E(o,r[0].code),y&1&&te(l.value)!==r[0].week&&E(l,r[0].week),y&1&&c.value!==r[0].name&&E(c,r[0].name),y&1&&C.value!==r[0].city&&E(C,r[0].city),y&1&&A.value!==r[0].circuit&&E(A,r[0].circuit)},i:ne,o:ne,d(r){r&&b(e),r&&b(t),X=!1,ce(z)}}}function Ce(s,e,t){let n;he(s,D,u=>t(0,n=u));const i=()=>{const u=new _e(`${n.name} SEMAINE ${n.week}`,n);u.setSheet(new be),u.setSheet(new fe),u.setSheet(new de),u.setSheet(new Ee),u.download()};function o(){n.code=this.value,D.set(n)}function w(){n.week=te(this.value),D.set(n)}function f(){n.name=this.value,D.set(n)}function v(){n.city=this.value,D.set(n)}function l(){n.circuit=this.value,D.set(n)}return[n,i,o,w,f,v,l]}class Le extends re{constructor(e){super();le(this,e,Ce,ye,ue,{})}}export{Le as default};
